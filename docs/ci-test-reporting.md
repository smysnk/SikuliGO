# CI Test Reporting

This document defines how SikuliGO publishes test execution and coverage in GitHub Actions.

## Workflow

- Workflow file: `.github/workflows/go-test.yml`
- Triggered on:
  - `push` to `master` for Go and docs changes
  - `pull_request` for Go and docs changes
  - manual `workflow_dispatch`

## Published test outputs

The workflow writes all outputs into `test-results/` and uploads them as the `go-test-results` artifact.

- `junit.xml`: JUnit report generated by `gotestsum` for GitHub check-style reporting.
- `go-test.json`: machine-readable Go test event stream from `gotestsum`.
- `coverage.out`: raw Go coverage profile.
- `coverage.txt`: human-readable function coverage from `go tool cover -func`.
- `coverage.cobertura.xml`: Cobertura XML generated from `coverage.out`.

## GitHub-friendly visibility

- Test report publication:
  - Uses `dorny/test-reporter` with JUnit input.
  - Automatically skipped for forked pull requests where check-write permissions are unavailable.
- Job summary:
  - Posts total coverage and full function coverage output to `$GITHUB_STEP_SUMMARY`.
- Artifact upload:
  - Uploads all `test-results/` files for download and downstream tooling.

## Local parity command

To run the same validation gates locally:

```bash
go mod tidy
go vet ./...
go test -race -covermode=atomic -coverprofile=coverage.out ./...
go tool cover -func=coverage.out
```
