[
  {
    "name": "single_exact_match",
    "haystack": [
      [10, 10, 10, 10, 10, 10],
      [10, 10, 5, 9, 10, 10],
      [10, 10, 20, 40, 10, 10],
      [10, 10, 10, 10, 10, 10],
      [10, 10, 10, 10, 10, 10],
      [10, 10, 10, 10, 10, 10]
    ],
    "needle": [
      [5, 9],
      [20, 40]
    ],
    "threshold": 0.999,
    "resize_factor": 1.0,
    "max_results": 1,
    "expected": [
      {
        "x": 2,
        "y": 1,
        "w": 2,
        "h": 2,
        "score_min": 0.999,
        "score_max": 1.0
      }
    ]
  },
  {
    "name": "multiple_matches_sorted",
    "haystack": [
      [10, 10, 10, 10, 10, 10, 10, 10],
      [10, 0, 255, 10, 10, 10, 10, 10],
      [10, 255, 0, 10, 0, 255, 10, 10],
      [10, 10, 10, 10, 255, 0, 10, 10],
      [10, 10, 10, 10, 10, 10, 10, 10]
    ],
    "needle": [
      [0, 255],
      [255, 0]
    ],
    "threshold": 0.999,
    "resize_factor": 1.0,
    "max_results": 0,
    "expected": [
      {
        "x": 1,
        "y": 1,
        "w": 2,
        "h": 2,
        "score_min": 0.999,
        "score_max": 1.0
      },
      {
        "x": 4,
        "y": 2,
        "w": 2,
        "h": 2,
        "score_min": 0.999,
        "score_max": 1.0
      }
    ]
  },
  {
    "name": "threshold_filters_non_match",
    "haystack": [
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0]
    ],
    "needle": [
      [12, 99, 35],
      [44, 17, 200],
      [88, 66, 3]
    ],
    "threshold": 0.9,
    "resize_factor": 1.0,
    "max_results": 0,
    "expected": []
  },
  {
    "name": "mask_ignores_noise",
    "haystack": [
      [0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0],
      [0, 0, 10, 20, 0, 0],
      [0, 0, 30, 40, 0, 0],
      [0, 0, 0, 0, 0, 0]
    ],
    "needle": [
      [10, 200],
      [30, 40]
    ],
    "mask": [
      [1, 0],
      [1, 1]
    ],
    "threshold": 0.999,
    "resize_factor": 1.0,
    "max_results": 1,
    "expected": [
      {
        "x": 2,
        "y": 2,
        "w": 2,
        "h": 2,
        "score_min": 0.999,
        "score_max": 1.0
      }
    ]
  },
  {
    "name": "resize_factor_applied",
    "haystack": [
      [0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 100, 100, 0, 0],
      [0, 0, 0, 100, 100, 0, 0],
      [0, 150, 150, 255, 255, 0, 0],
      [0, 150, 150, 255, 255, 0, 0],
      [0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0]
    ],
    "needle": [
      [0, 100],
      [150, 255]
    ],
    "threshold": 0.999,
    "resize_factor": 2.0,
    "max_results": 1,
    "expected": [
      {
        "x": 1,
        "y": 1,
        "w": 4,
        "h": 4,
        "score_min": 0.999,
        "score_max": 1.0
      }
    ]
  }
]

